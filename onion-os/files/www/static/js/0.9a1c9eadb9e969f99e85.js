webpackJsonp([0],{AYtA:function(t,a){},pNZA:function(t,a,s){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=s("BO1k"),n=s.n(i),e={name:"AppManagerApp",data:function(){return{currentTab:"available",tabs:{available:{name:"Available"},installed:{name:"Installed"}},isLoading:!0,isInstalling:!1,installedApps:[],availableApps:[],appFilter:""}},methods:{mergedAppList:function(){for(var t=0;t<this.availableApps.length;t++){var a=this.availableApps[t];this.installedApps.indexOf(a.id)>-1&&(a.installed=!0,this.$set(this.availableApps,t,a))}},appShow:function(t){return"installed"!==this.currentTab||t.installed},getApps:function(){var t=this;this.isLoading=!0,this.$store.dispatch("handleScript",{code:'if [ ! -f /tmp/oos-app-list ]; then sleep 1; opkg update; opkg find "oos-app*" > /tmp/oos-app-list; fi'}).then(function(a){return t.$store.dispatch("waitProcess",{pid:a.pid})}).then(function(){return t.$store.dispatch("readFile",{path:"/tmp/oos-app-list"})}).then(function(a){t.availableApps=[];var s=!0,i=!1,e=void 0;try{for(var l,p=n()(a.data.split("\n"));!(s=(l=p.next()).done);s=!0){var r=l.value;if(!(r.length<2)){var c=r.split(" - ");t.availableApps.push({id:c[0],version:c[1],description:c[2]})}}}catch(t){i=!0,e=t}finally{try{!s&&p.return&&p.return()}finally{if(i)throw e}}t.mergedAppList(),t.isLoading=!1})},getInstalledApps:function(){var t=this;this.$store.dispatch("handleCommand",{cmd:"opkg",params:["list-installed"]}).then(function(a){t.installedApps=[];var s=!0,i=!1,e=void 0;try{for(var l,p=n()(a.stdout.split("\n"));!(s=(l=p.next()).done);s=!0){var r=l.value;if(r.indexOf("oos-app")>-1){var c=r.split(" - ");t.installedApps.push(c[0])}}}catch(t){i=!0,e=t}finally{try{!s&&p.return&&p.return()}finally{if(i)throw e}}t.mergedAppList()})},openApp:function(t){this.$store.dispatch("launchApp",{appId:t.id})},installApp:function(t,a){var s=this;this.isInstalling=!0,t.installing=!0,this.$set(this.availableApps,a,t),this.$store.dispatch("handleScript",{code:"opkg install "+t.id}).then(function(t){return s.$store.dispatch("waitProcess",{pid:t.pid})}).then(function(){t.installing=!1,t.installed=!0,s.isInstalling=!1,s.$set(s.availableApps,a,t),s.$store.dispatch("refreshAppList")})},removeApp:function(t,a){var s=this;this.isInstalling=!0,t.installing=!0,this.$set(this.availableApps,a,t),this.$store.dispatch("handleScript",{code:"opkg remove "+t.id}).then(function(t){return s.$store.dispatch("waitProcess",{pid:t.pid})}).then(function(){t.installing=!1,t.installed=!1,s.isInstalling=!1,s.$set(s.availableApps,a,t),s.$store.dispatch("refreshAppList")})}},created:function(){this.getApps(),this.getInstalledApps()}},l={render:function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"container app-view"},[s("ul",{staticClass:"tab tab-block"},t._l(t.tabs,function(a,i){return s("li",{key:i,staticClass:"tab-item"},[s("a",{staticClass:"c-hand",class:{active:i===t.currentTab,badge:a.badge},attrs:{"data-badge":a.badge},on:{click:function(a){t.currentTab=i}}},[t._v(t._s(a.name))])])})),t._v(" "),s("div",{staticClass:"app-body"},[s("ul",{staticClass:"menu app-menu"},[s("li",{staticClass:"menu-item"},[s("div",{staticClass:"tile tile-centered"},[s("div",{staticClass:"tile-icon",on:{click:t.getApps}},[s("img",{staticClass:"avatar",attrs:{src:"static/img/icons/store.svg"}})]),t._v(" "),s("div",{staticClass:"tile-content"},[t._v("App Manager")])])]),t._v(" "),s("li",{staticClass:"divider"}),t._v(" "),t._l(t.tabs,function(a,i){return s("li",{key:i,staticClass:"menu-item"},[s("a",{staticClass:"c-hand",class:{active:i===t.currentTab,badge:a.badge},attrs:{"data-badge":a.badge},on:{click:function(a){t.currentTab=i}}},[t._v("\n          "+t._s(a.name)+"\n        ")])])})],2),t._v(" "),s("div",{staticClass:"app-content"},[s("div",{staticClass:"card app-list"},[s("div",{staticClass:"card-header"},[s("span",{staticClass:"loading-lg loading-icon float-right",class:{loading:t.isLoading}}),t._v(" "),s("span",{staticClass:"card-title h5"},[t._v("Onion OS Apps ")])]),t._v(" "),s("div",{staticClass:"card-body app-list-body"},t._l(t.availableApps,function(a,i){return s("div",{directives:[{name:"show",rawName:"v-show",value:t.appShow(a),expression:"appShow(app)"}],key:a.id,staticClass:"card app-item"},[s("div",{staticClass:"card-body"},[s("img",{staticClass:"app-icon",attrs:{src:"http://repo.onioniot.com/onionos/apps/icons/"+a.id+".svg",onerror:"this.src = 'static/img/icons/onion.svg'",alt:""}}),t._v(" "),s("div",{staticClass:"app-discription"},[t._v("\n                "+t._s(a.description)+" ("+t._s(a.version)+")\n              ")])]),t._v(" "),s("div",{staticClass:"card-footer"},[a.installed?s("button",{staticClass:"btn btn-error float-right",class:{loading:a.installing,disabled:t.isInstalling},on:{click:function(s){t.removeApp(a,i)}}},[t._v("Remove")]):t._e(),t._v(" "),a.installed?t._e():s("button",{staticClass:"btn btn-success float-right",class:{loading:a.installing,disabled:t.isInstalling},on:{click:function(s){t.installApp(a,i)}}},[t._v("Install")])])])}))])])])])},staticRenderFns:[]};var p=s("VU/8")(e,l,!1,function(t){s("AYtA")},"data-v-7edf3305",null);a.default=p.exports}});
//# sourceMappingURL=0.9a1c9eadb9e969f99e85.js.map